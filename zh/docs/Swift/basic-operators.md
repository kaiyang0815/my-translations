# 基本运算符

Swift 中的运算符是用于检查、修改或组合值的特殊符号或短语。比如，加法运算符（+）用于将两个数字相加，如 `let i = 1 + 2`；逻辑与运算符（&&）用于组合两个布尔值，如 `if enteredDoorCode && passedRetinaScan`。

Swift 不仅支持常见编程语言（如 C）中的运算符，还对其进行了多项改进以避免常见的编码错误：

- 赋值运算符（=）不返回值，这可以防止在本应使用相等运算符（==）时误用赋值运算符
- 算术运算符（+、-、\*、/、% 等）会检测并禁止值溢出，避免在处理超出类型允许范围的数值时产生意外结果
- 可以使用专门的溢出运算符来显式处理溢出情况

此外，Swift 还提供了一些 C 语言中没有的范围运算符，如 `a..<b` 和 `a...b`，用于简便地表示值的范围。

## 运算符的分类

根据操作数的数量，运算符可以分为以下三类：

- **一元运算符**：对单个操作数进行操作（如 `-a`）
  - 前缀运算符：位于操作数之前（如 `!b`）
  - 后缀运算符：位于操作数之后（如 `c!`）
- **二元运算符**：对两个操作数进行操作（如 `2 + 3`），也称为中缀运算符，因为运算符位于两个操作数之间
- **三元运算符**：对三个操作数进行操作。Swift 中只有一个三元运算符，即三元条件运算符（`a ? b : c`）

## 赋值运算符

赋值运算符（`a = b`）用于将 b 的值赋给 a：

```swift
let b = 10
var a = 5
a = b
// a 现在等于 10
```

如果赋值表达式的右侧是一个包含多个值的元组，可以一次性将其分解为多个常量或变量：

```swift
let (x, y) = (1, 2)
// x 等于 1，y 等于 2
```

Swift 中的赋值运算符与 C 和 Objective-C 不同，它本身不返回值。这样的设计可以避免在本应使用相等运算符（==）时误用赋值运算符（=）。

## 算术运算符

Swift 为所有数字类型提供了四种基本的算术运算符：

- 加法（+）
- 减法（-）
- 乘法（\*）
- 除法（/）

```swift
1 + 2       // 等于 3
5 - 3       // 等于 2
2 * 3       // 等于 6
10.0 / 2.5  // 等于 4.0
```

与 C 和 Objective-C 不同，Swift 的算术运算符默认不允许值溢出。如果需要处理溢出情况，可以使用特殊的溢出运算符（如 `a &+ b`）。

加法运算符也可用于字符串拼接：

```swift
"你好, " + "世界"  // 等于 "你好, 世界"
```

## 余数运算符

余数运算符（`a % b`）用于计算 a 除以 b 后的余数。

> 注意：尽管余数运算符（%）在其他语言中也被称为模运算符，但由于它在 Swift 中处理负数的方式，严格来说它执行的是求余运算而非模运算。

余数运算的工作原理如下。以计算 `9 % 4` 为例：

1. 首先确定 9 中最多可以容纳几个 4
2. 可以容纳 2 个 4，余数为 1

在 Swift 中可以这样写：

```swift
9 % 4  // 等于 1
```

对于负数，计算方式相同：

```swift
-9 % 4  // 等于 -1
```

需要注意的是，b 的符号会被忽略。这意味着 `a % b` 和 `a % -b` 的结果始终相同。

## 复合赋值运算符

Swift 提供了复合赋值运算符，将赋值（=）与其他运算符组合在一起，例如加法赋值运算符（+=）：

```swift
var a = 1
a += 2
// a 现在等于 3
```

复合赋值运算符实际上是下面形式的简写：

```swift
a = a + 2
```

## 比较运算符

Swift 支持以下比较运算符：

- 等于（`a == b`）
- 不等于（`a != b`）
- 大于（`a > b`）
- 小于（`a < b`）
- 大于等于（`a >= b`）
- 小于等于（`a <= b`）

比较运算符返回一个表示语句是否成立的布尔值：

```swift
1 == 1   // true
2 != 1   // true
2 > 1    // true
1 < 2    // true
1 >= 1   // true
2 <= 1   // false
```

比较运算符经常用在条件语句中：

```swift
let name = "小明"
if name == "小明" {
    print("你好，小明！")
} else {
    print("抱歉，认错人了。")
}
```

## 三元条件运算符

三元条件运算符是一种特殊的运算符，有三个部分，格式为 `问题 ? 答案1 : 答案2`。它是下面代码的简写形式：

```swift
if 问题 {
    答案1
} else {
    答案2
}
```

例如：

```swift
let contentHeight = 40
let hasHeader = true
let rowHeight = contentHeight + (hasHeader ? 50 : 20)
// rowHeight 等于 90
```

## 空合并运算符

空合并运算符（`a ?? b`）在 a 有值时返回 a，在 a 为空时返回默认值 b。这是下面代码的简写形式：

```swift
a != nil ? a! : b
```

空合并运算符提供了一种优雅的方式来处理可选值：

```swift
let defaultColor = "红色"
var userDefinedColor: String?   // 默认为 nil
var colorToUse = userDefinedColor ?? defaultColor
// userDefinedColor 为 nil，所以 colorToUse 被设置为 "红色"
```

## 范围运算符

Swift 提供了几种方便的方式来表示值的范围：

- 闭区间运算符（`a...b`）定义一个包含 a 和 b 的范围
- 半开区间运算符（`a..<b`）定义一个包含 a 但不包含 b 的范围
- 单侧区间运算符可以一直延续到数组或集合的开始（`...b`）或结束（`a...`）

这些范围运算符在 for 循环和数组操作中特别有用：

```swift
for index in 1...5 {
    print("\(index) 乘以 5 等于 \(index * 5)")
}

let names = ["小明", "小红", "小刚"]
for name in names[..<2] {
    print(name)
}
// 打印 "小明" 和 "小红"
```

## 逻辑运算符

Swift 提供了三种标准的逻辑运算符：

- 逻辑非（`!a`）：将布尔值取反
- 逻辑与（`a && b`）：只有当 a 和 b 都为 true 时，结果才为 true
- 逻辑或（`a || b`）：只要 a 或 b 有一个为 true，结果就为 true

这些运算符通常用于条件语句中：

```swift
let hasDoorKey = false
let knowsOverridePassword = true
if hasDoorKey || knowsOverridePassword {
    print("欢迎进入！")
} else {
    print("访问被拒绝。")
}
```

> 注意：Swift 的逻辑运算符 && 和 || 是左结合的，这意味着复合表达式会优先计算最左边的子表达式。

## 使用括号明确优先级

当涉及复杂的运算时，可以使用括号来明确运算的优先顺序。括号内的表达式会优先计算：

```swift
let result = (1 + 2) * 3    // 等于 9
let anotherResult = 1 + (2 * 3)  // 等于 7
```

使用括号不仅可以控制运算的优先级，还能提高代码的可读性。即使在运算符的优先级已经能够正确计算的情况下，适当地使用括号也能使代码的意图更加清晰。
